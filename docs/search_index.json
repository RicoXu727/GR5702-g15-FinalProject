[["results.html", "Chapter 4 Results", " Chapter 4 Results ## Including Plots frist group by county ## [1] &quot;Invoice/Item Number&quot; &quot;Date&quot; &quot;Store Number&quot; ## [4] &quot;Store Name&quot; &quot;Address&quot; &quot;City&quot; ## [7] &quot;Zip Code&quot; &quot;Store Location&quot; &quot;County Number&quot; ## [10] &quot;County&quot; &quot;Category&quot; &quot;Category Name&quot; ## [13] &quot;Vendor Number&quot; &quot;Vendor Name&quot; &quot;Item Number&quot; ## [16] &quot;Item Description&quot; &quot;Pack&quot; &quot;Bottle Volume (ml)&quot; ## [19] &quot;State Bottle Cost&quot; &quot;State Bottle Retail&quot; &quot;Bottles Sold&quot; ## [22] &quot;Sale (Dollars)&quot; &quot;Volume Sold (Liters)&quot; &quot;Volume Sold (Gallons)&quot; select geo-related cols ## # A tibble: 90,584 × 7 ## County `Category Name` Bottle…¹ Pack Bottl…² Sale …³ Volum…⁴ ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 BOONE WHISKEY LIQUEUR 50 1 1 45 0.01 ## 2 CERRO GORD AMERICAN VODKAS 750 12 12 60.1 2.37 ## 3 BLACK HAWK 100% AGAVE TEQUILA 750 12 36 729 7.13 ## 4 POLK AMERICAN DRY GINS 375 12 24 240. 2.37 ## 5 POLK COCKTAILS /RTD 1750 6 6 62.8 2.77 ## 6 JACKSON AMERICAN CORDIALS &amp; LIQUEUR 1000 12 12 73.0 3.17 ## 7 SCOTT AMERICAN VODKAS 1000 12 12 167. 3.17 ## 8 CLARKE AMERICAN VODKAS 1750 6 6 58.5 2.77 ## 9 POTTAWATTA WHISKEY LIQUEUR 50 10 5 42.4 0.06 ## 10 CERRO GORD IMPORTED VODKAS 375 24 4 30.0 0.39 ## # … with 90,574 more rows, and abbreviated variable names ## # ¹​`Bottle Volume (ml)`, ²​`Bottles Sold`, ³​`Sale (Dollars)`, ## # ⁴​`Volume Sold (Gallons)` Note that the echo = FALSE parameter was added to the code chunk to prevent printing of the R code that generated the plot. ## # A tibble: 90 × 3 ## County value type ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 POLK 2232. bottle_in_100 ## 2 LINN 948. bottle_in_100 ## 3 SCOTT 775. bottle_in_100 ## 4 BLACK HAWK 686. bottle_in_100 ## 5 JOHNSON 544. bottle_in_100 ## 6 WOODBURY 430. bottle_in_100 ## 7 POTTAWATTA 390. bottle_in_100 ## 8 STORY 249. bottle_in_100 ## 9 CERRO GORD 239. bottle_in_100 ## 10 DUBUQUE 239. bottle_in_100 ## # … with 80 more rows ## # A tibble: 30 × 3 ## County value type ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 POLK 29469. dollars_in_100 ## 2 LINN 11723. dollars_in_100 ## 3 SCOTT 9433. dollars_in_100 ## 4 BLACK HAWK 7908. dollars_in_100 ## 5 JOHNSON 7779. dollars_in_100 ## 6 WOODBURY 5274. dollars_in_100 ## 7 POTTAWATTA 5160. dollars_in_100 ## 8 STORY 3638. dollars_in_100 ## 9 CERRO GORD 3133. dollars_in_100 ## 10 DUBUQUE 3216. dollars_in_100 ## # … with 20 more rows check by alcohol category ## # A tibble: 3,337 × 5 ## # Groups: County [99] ## County `Category Name` bottle_sold dollar_100 volume ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 ADAIR CANADIAN WHISKIES 390 41.9 93.2 ## 2 ADAIR AMERICAN VODKAS 312 27.0 70.9 ## 3 ADAIR SPICED RUM 91 7.92 16.1 ## 4 ADAIR STRAIGHT BOURBON WHISKIES 76 10.1 21.5 ## 5 ADAIR TENNESSEE WHISKIES 64 14.5 12.8 ## 6 ADAIR MIXTO TEQUILA 62 7.99 11.1 ## 7 ADAIR WHISKEY LIQUEUR 58 10.8 11 ## 8 ADAIR AMERICAN FLAVORED VODKA 54 5.08 9.85 ## 9 ADAIR IMPORTED VODKAS 42 6.07 7.71 ## 10 ADAIR IRISH WHISKIES 28 2.91 2.81 ## # … with 3,327 more rows ## # A tibble: 30 × 2 ## County count ## &lt;chr&gt; &lt;dbl&gt; ## 1 POLK 90211 ## 2 LINN 41911 ## 3 SCOTT 32585 ## 4 JOHNSON 22852 ## 5 BLACK HAWK 21946 ## 6 WOODBURY 21121 ## 7 POTTAWATTA 16070 ## 8 CERRO GORD 11486 ## 9 DUBUQUE 9847 ## 10 STORY 9439 ## # … with 20 more rows ## [1] &quot;POLK&quot; &quot;LINN&quot; &quot;SCOTT&quot; &quot;JOHNSON&quot; &quot;BLACK HAWK&quot; ## [6] &quot;WOODBURY&quot; &quot;POTTAWATTA&quot; &quot;CERRO GORD&quot; &quot;DUBUQUE&quot; &quot;STORY&quot; ## [11] &quot;WEBSTER&quot; &quot;MUSCATINE&quot; &quot;MARSHALL&quot; &quot;DALLAS&quot; &quot;DES MOINES&quot; ## [16] &quot;DICKINSON&quot; &quot;CLINTON&quot; &quot;LEE&quot; &quot;WAPELLO&quot; &quot;JASPER&quot; ## [21] &quot;HENRY&quot; &quot;MARION&quot; &quot;OBRIEN&quot; &quot;BOONE&quot; &quot;KOSSUTH&quot; ## [26] &quot;JONES&quot; &quot;WASHINGTON&quot; &quot;CARROLL&quot; &quot;BREMER&quot; &quot;PLYMOUTH&quot; ## # A tibble: 30 × 4 ## County bottle_sold_100 dollar_100 volume ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 POLK 2232. 29469. 45139. ## 2 LINN 948. 11723. 19873. ## 3 SCOTT 775. 9433. 15360. ## 4 BLACK HAWK 686. 7908. 13222. ## 5 JOHNSON 544. 7779. 12624. ## 6 WOODBURY 430. 5274. 8713. ## 7 POTTAWATTA 390. 5160. 8370. ## 8 STORY 249. 3638. 6136. ## 9 CERRO GORD 239. 3133. 5991. ## 10 DUBUQUE 239. 3216. 5430. ## # … with 20 more rows install.packages(‘devtools’) install usmap ## [1] FALSE ## [1] &quot;19155&quot; ## fips bottle_sold_100 dollar_100 volume ## 1 polk 2232.15 29468.6685 45139.36 ## 2 linn 948.46 11722.9802 19873.47 ## 3 scott 775.01 9432.5842 15360.11 ## 4 black hawk 685.79 7908.0374 13221.75 ## 5 johnson 543.94 7778.8321 12624.14 ## 6 woodbury 430.47 5274.0121 8713.44 ## 7 pottawatta 390.41 5159.7299 8369.91 ## 8 story 248.63 3638.0693 6135.94 ## 9 cerro gord 239.41 3133.2310 5991.23 ## 10 dubuque 239.05 3216.3971 5430.03 ## 11 dallas 160.57 2733.4192 4141.05 ## 12 webster 154.52 1846.8317 3388.43 ## 13 muscatine 147.45 1675.7291 2842.56 ## 14 des moines 144.33 1750.6705 2976.77 ## 15 marshall 136.13 1802.8206 2924.99 ## 16 clinton 130.50 1604.5010 2981.50 ## 17 lee 129.67 1716.0825 3231.69 ## 18 dickinson 114.06 1656.6805 2874.33 ## 19 wapello 94.10 1077.2274 1753.18 ## 20 marion 71.50 907.0488 1565.58 ## 21 jasper 70.47 784.3259 1338.15 ## 22 boone 68.31 941.4461 1531.64 ## 23 henry 60.87 831.2411 1378.66 ## 24 washington 59.35 782.6217 1306.72 ## 25 bremer 57.52 775.8921 1479.03 ## 26 buena vist 55.99 755.1428 1343.77 ## 27 carroll 55.93 784.6769 1422.80 ## 28 kossuth 54.72 786.0217 1425.12 ## 29 obrien 54.00 861.5931 1551.28 ## 30 plymouth 53.03 687.1619 1301.88 data &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/RicoXu727/Leetcode-Note/main/2019_Iowa_Liquor_Sales_sample.csv&quot;, show_col_types = FALSE) # change to date class date_in_date &lt;- as.Date(data$Date, format = &quot;%m/%d/%Y&quot;) data_new &lt;- cbind(data, date_in_date) date_unique &lt;- unique(data_new$date_in_date) bottles &lt;- c() for (i in date_unique) { index &lt;- data_new$date_in_date == i total &lt;- sum(data_new$`Bottles Sold`[index], na.rm = TRUE) bottles &lt;- append(bottles,total) } df_bottles &lt;- data.frame( &quot;date_unique&quot; = date_unique, &quot;total_bottles&quot; = bottles ) library(lubridate) library(ggplot2) g &lt;- ggplot(df_bottles, aes(date_unique, total_bottles)) + geom_point() + ggtitle(&quot;Total Bottles Sold by Date in 2019&quot;)+ labs (x = &quot;date&quot;, y = &quot;bottles&quot;) g + geom_line(color = &quot;grey30&quot;) + geom_smooth(color = &quot;blue&quot;, se = FALSE) library(plotly) p &lt;- plot_ly( df_bottles, x = ~date_unique, y = ~total_bottles, type = &quot;scatter&quot;, mode = &quot;line+markers&quot;, hoverinfo = &quot;text&quot; ) p mon &lt;- c() for (i in 1:length(date_unique)) { mon &lt;- append(mon, months(date_unique[i])) } df_bottles &lt;- cbind(df_bottles, &quot;month&quot; = c(mon)) month_bottles &lt;- c() for (i in c(month.name)) { index &lt;- df_bottles$month == i total &lt;- sum(df_bottles$total_bottles[index], na.rm = TRUE) month_bottles &lt;- append(month_bottles,total) } df_bottles_month &lt;- data.frame( &quot;month&quot; = month.name, &quot;total_bottles&quot; = month_bottles ) df_bottles_month$month &lt;- factor(df_bottles_month$month, levels = unique(df_bottles_month$month), ordered = TRUE) ggplot(df_bottles_month, aes(month, total_bottles, group=1)) + geom_line() + ggtitle(&quot;Total Bottles Sold by Month in 2019&quot;) + labs (x = &quot;month&quot;, y = &quot;bottles&quot;) + geom_smooth(method = &quot;loess&quot;, span = .75, se = FALSE, lwd = 1.5)+ theme(axis.text.x = element_text(angle=45)) g &lt;- ggplot(df_bottles, aes(date_unique, total_bottles)) + geom_line() + ggtitle(&quot;Bottles sold on Fridays&quot;) + labs (x = &quot;date&quot;, y = &quot;bottles&quot;) friday &lt;- df_bottles |&gt; filter(wday(date_unique) == 6) g + geom_point(data = friday, aes(date_unique, total_bottles), color = &quot;deeppink&quot;) ggplot(df_bottles, aes(date_unique, total_bottles)) + geom_line() + facet_grid(wday(date_unique, label = TRUE)) + ggtitle(&quot;Total Bottles Sold by Date in 2019&quot;)+ labs (x = &quot;date&quot;, y = &quot;bottles&quot;) df_december &lt;- filter(df_bottles, month == &quot;December&quot;) df_november &lt;- filter(df_bottles, month == &quot;November&quot;) df_nov_dec &lt;- rbind(df_november, df_december) g &lt;- ggplot(df_nov_dec, aes(date_unique, total_bottles)) + geom_line(color = &quot;deeppink&quot;) + geom_point(color = &quot;deeppink&quot;) + scale_y_continuous(limits = c(0,7000)) + geom_smooth() + ggtitle(&quot;Bottles Sold in November &amp; December in 2019&quot;) + labs(x = &quot;day&quot;, y = &quot;bottle&quot;) start &lt;- as.Date(&quot;2019-12-24&quot;) end &lt;- as.Date(&quot;2019-12-31&quot;) g + annotate(&quot;rect&quot;, xmin = as.Date(&quot;2019-12-24&quot;), xmax = as.Date(&quot;2019-12-31&quot;), ymin = -Inf, ymax = Inf, fill = &quot;green&quot;, alpha = 0.2) + annotate(&quot;text&quot;,, x = as.Date(&quot;2019-12-24&quot;) -8, y = 6800, label = &quot;Dec 24 - Dec 31&quot;, color = &quot;green&quot;, hjust = 0) + annotate(&quot;rect&quot;, xmin = as.Date(&quot;2019-11-23&quot;), xmax = as.Date(&quot;2019-11-27&quot;), ymin = -Inf, ymax = Inf, fill = &quot;blue&quot;, alpha = 0.2) + annotate(&quot;text&quot;,, x = as.Date(&quot;2019-11-23&quot;), y = 6800, label = &quot;Nov 23 - Nov 27&quot;, color = &quot;blue&quot;, hjust = 0) + theme_classic() mon &lt;- c() for (i in 1:length(date_in_date)) { mon &lt;- append(mon, months(date_in_date[i])) } data_new &lt;- cbind(data_new, &quot;month&quot; = c(mon)) cate &lt;- unique(data_new$`Category Name`) df_para &lt;- data.frame( &quot;category&quot; = cate ) for (i in 1:12) { mon &lt;- c() df_mon &lt;- filter(data_new, month == month.name[i]) for (j in 1:length(cate)) { index &lt;- df_mon$`Category Name` == cate[j] total &lt;- sum(df_mon$`Bottles Sold`[index], na.rm = TRUE) mon &lt;- append(mon,total) } df_para &lt;- cbind(df_para, mon) } library(GGally) colnames(df_para) &lt;- c(&quot;category&quot;, &quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;July&quot;, &quot;August&quot;, &quot;September&quot;, &quot;October&quot;, &quot;November&quot;, &quot;December&quot;) ggparcoord(df_para) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
